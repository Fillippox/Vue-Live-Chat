(function(){"use strict";var e={3936:function(e,n,r){var t=r(9242),o=r(3396);function a(e,n){const r=(0,o.up)("router-view");return(0,o.wg)(),(0,o.j4)(r)}var l=r(89);const s={},u=(0,l.Z)(s,[["render",a]]);var i=u,c=r(2483);const d={class:"welcome container"},p=(0,o._)("p",null," Welcome to the chatroom",-1),m={key:0},g=(0,o._)("h2",null,"Login to the chat room",-1),v={key:1},h=(0,o._)("h2",null,"Sign up to the chat room",-1);function f(e,n,r,t,a,l){const s=(0,o.up)("LogInForm"),u=(0,o.up)("SignUpForm");return(0,o.wg)(),(0,o.iD)("div",d,[p,t.showLogin?((0,o.wg)(),(0,o.iD)("div",m,[g,(0,o.Wm)(s,{onLogin:t.enterChat},null,8,["onLogin"]),(0,o._)("p",null,[(0,o.Uk)("No account yet? "),(0,o._)("span",{onClick:n[0]||(n[0]=e=>t.showLogin=!1)}," Signup "),(0,o.Uk)(" instead")])])):((0,o.wg)(),(0,o.iD)("div",v,[h,(0,o.Wm)(u,{onSignUp:t.enterChat},null,8,["onSignUp"]),(0,o._)("p",null,[(0,o.Uk)("Already registered? "),(0,o._)("span",{onClick:n[1]||(n[1]=e=>t.showLogin=!0)}," Login "),(0,o.Uk)(" instead")])]))])}r(7658);var w=r(7139);const y={class:"error"},b=(0,o._)("button",null,"Sign up",-1);function _(e,n,r,a,l,s){return(0,o.wg)(),(0,o.iD)("form",{onSubmit:n[3]||(n[3]=(0,t.iM)(((...e)=>a.handleSubmit&&a.handleSubmit(...e)),["prevent"]))},[(0,o.wy)((0,o._)("input",{type:"text",required:"",placeholder:"display name","onUpdate:modelValue":n[0]||(n[0]=e=>a.displayName=e)},null,512),[[t.nr,a.displayName]]),(0,o.wy)((0,o._)("input",{type:"email",required:"",placeholder:"email","onUpdate:modelValue":n[1]||(n[1]=e=>a.email=e)},null,512),[[t.nr,a.email]]),(0,o.wy)((0,o._)("input",{type:"password",required:"",placeholder:"password","onUpdate:modelValue":n[2]||(n[2]=e=>a.password=e)},null,512),[[t.nr,a.password]]),(0,o._)("div",y,(0,w.zw)(a.error),1),b],32)}var S=r(4870),k=r(3581);r(8307),r(5866);const C={apiKey:"AIzaSyB9aXWQYybyLygnytcVVwHs0oDuKCJ7kUI",authDomain:"vue-project-53f81.firebaseapp.com",projectId:"vue-project-53f81",storageBucket:"vue-project-53f81.appspot.com",messagingSenderId:"500881800265",appId:"1:500881800265:web:b3a6ba3ee474dada01d398"},U=(k.Z.initializeApp(C),k.Z.auth()),D=k.Z.firestore(),H=k.Z.firestore.FieldValue.serverTimestamp;k.Z.firestore();const O=(0,S.iH)(null),j=async(e,n,r)=>{O.value=null;try{const t=await U.createUserWithEmailAndPassword(e,n);if(!t)throw new Error("Could not complete the signup");return await t.user.updateProfile({displayName:r}),O.value=null,t}catch(t){console.log(t.message),O.value=t.message}},Z=()=>({error:O,signup:j});var x=Z,A={setup(e,n){const{error:r,signup:t}=x(),o=(0,S.iH)(""),a=(0,S.iH)(""),l=(0,S.iH)(""),s=async()=>{await t(a.value,l.value,o.value),n.emit("signUp")};return{email:a,password:l,displayName:o,handleSubmit:s,error:r}}};const L=(0,l.Z)(A,[["render",_]]);var V=L;const N={class:"error"},W=(0,o._)("button",null,"Log in",-1);function z(e,n,r,a,l,s){return(0,o.wg)(),(0,o.iD)("form",{onSubmit:n[2]||(n[2]=(0,t.iM)(((...e)=>a.handleSubmit&&a.handleSubmit(...e)),["prevent"]))},[(0,o.wy)((0,o._)("input",{type:"email",required:"",placeholder:"email","onUpdate:modelValue":n[0]||(n[0]=e=>a.email=e)},null,512),[[t.nr,a.email]]),(0,o.wy)((0,o._)("input",{type:"password",required:"",placeholder:"password","onUpdate:modelValue":n[1]||(n[1]=e=>a.password=e)},null,512),[[t.nr,a.password]]),(0,o._)("div",N,(0,w.zw)(e.error),1),W],32)}const E=(0,S.iH)(null),F=async(e,n)=>{E.value=null;try{const r=await U.signInWithEmailAndPassword(e,n);return E.value=null,console.log(r),r}catch(r){console.log(r.value),E.value="Incorrect login credentials"}},P=()=>({error:E,login:F});var I=P,q={setup(e,n){const r=(0,S.iH)(""),t=(0,S.iH)(""),{error:o,login:a}=I(),l=async()=>{await a(r.value,t.value),o.value||n.emit("login")};return{email:r,password:t,handleSubmit:l}}};const M=(0,l.Z)(q,[["render",z]]);var T=M;const B={key:0},K={class:"email"};function Y(e,n,r,t,a,l){return t.user?((0,o.wg)(),(0,o.iD)("nav",B,[(0,o._)("div",null,[(0,o._)("p",null," Hey there "+(0,w.zw)(t.user.displayName),1),(0,o._)("p",K," Currently logged in as "+(0,w.zw)(t.user.email),1)]),(0,o._)("div",null,[(0,o._)("button",{onClick:n[0]||(n[0]=(...e)=>t.handleClick&&t.handleClick(...e))},"Logout")])])):(0,o.kq)("",!0)}const J=(0,S.iH)(null),Q=async()=>{J.vale=null;try{await U.signOut()}catch(e){console.log(e.message),J.value=e.message}},R=()=>({logOut:Q,error:J});var X=R;(0,S.iH)(null);const G=(0,S.iH)(U.currentUser);U.onAuthStateChanged((e=>{console.log("User state change. Current user is",e),G.value=e}));const $=()=>({user:G});var ee=$,ne={setup(){const{logOut:e,error:n}=X(),{user:r}=ee(),t=async()=>{await e(),n.value||console.log("user logged out")};return{handleClick:t,user:r}}};const re=(0,l.Z)(ne,[["render",Y]]);var te=re,oe={components:{SignUpForm:V,LogInForm:T,NavBar:te},setup(){const e=(0,S.iH)(!0),n=(0,c.tv)(),r=()=>{n.push({name:"chatroom"})};return{showLogin:e,enterChat:r}}};const ae=(0,l.Z)(oe,[["render",f]]);var le=ae;const se=(0,o._)("p",null,"Chatroom created as a Vue project Filip RÄ™kas",-1),ue=(0,o._)("div",{class:"container"},null,-1);function ie(e,n,r,t,a,l){const s=(0,o.up)("NavBar"),u=(0,o.up)("ChatWindow"),i=(0,o.up)("NewChatForm");return(0,o.wg)(),(0,o.iD)(o.HY,null,[se,ue,(0,o.Wm)(s),(0,o.Wm)(u),(0,o.Wm)(i)],64)}const ce={class:"error"};function de(e,n,r,a,l,s){const u=(0,o.up)("vue-emoji-picker");return(0,o.wg)(),(0,o.iD)("form",null,[(0,o.wy)((0,o._)("textarea",{class:"comment-box",placeholder:"Type your best message...","onUpdate:modelValue":n[0]||(n[0]=e=>a.message=e),onKeypress:n[1]||(n[1]=(0,t.D2)((0,t.iM)(((...e)=>a.handleSubmit&&a.handleSubmit(...e)),["prevent"]),["enter"]))},null,544),[[t.nr,a.message]]),(0,o.Wm)(u,{modelValue:a.message,"onUpdate:modelValue":n[2]||(n[2]=e=>a.message=e)},null,8,["modelValue"]),(0,o._)("div",ce,(0,w.zw)(a.error),1)])}r(9434);const pe=e=>{const n=(0,S.iH)(null),r=async r=>{n.value=null;try{await D.collection(e).add(r)}catch(t){console.log(t.message),n.value="Could not send the message"}};return{error:n,addDoc:r}};var me=pe,ge={setup(){const{user:e}=ee(),{addDoc:n,error:r}=me("messages"),t=(0,S.iH)(""),o=async()=>{const o={name:e.value.displayName,message:t.value,createdAt:H()};await n(o),r.val||(t.value="")};return{message:t,handleSubmit:o,error:r}}};const ve=(0,l.Z)(ge,[["render",de]]);var he=ve;const fe={class:"class chat-window"},we={key:0},ye={key:1,class:"messages",ref:"messages"},be={class:"created-at"},_e={class:"name"},Se={class:"message"};function ke(e,n,r,t,a,l){return(0,o.wg)(),(0,o.iD)("div",fe,[t.error?((0,o.wg)(),(0,o.iD)("div",we,(0,w.zw)(t.error),1)):(0,o.kq)("",!0),t.documents?((0,o.wg)(),(0,o.iD)("div",ye,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(t.formattedDocuments,(e=>((0,o.wg)(),(0,o.iD)("div",{key:e.id,class:"single"},[(0,o._)("span",be,(0,w.zw)(e.createdAt),1),(0,o._)("span",_e,(0,w.zw)(e.name),1),(0,o._)("span",Se,(0,w.zw)(e.message),1)])))),128))],512)):(0,o.kq)("",!0)])}const Ce=e=>{const n=(0,S.iH)(null),r=(0,S.iH)(null);let t=D.collection(e).orderBy("createdAt");const a=t.onSnapshot((e=>{console.log("snapshot");let t=[];e.docs.forEach((e=>{e.data().createdAt&&t.push({...e.data(),id:e.id})})),n.value=t,r.value=null}),(e=>{console.log(e.message),n.value=null,r.value="Could not fetch data"}));return(0,o.m0)((e=>{e((()=>a()))})),{documents:n,error:r}};var Ue=Ce,De=r(6085),He={setup(){const{error:e,documents:n}=Ue("messages"),r=(0,o.Fl)((()=>{if(n.value)return n.value.map((e=>{let n=(0,De.Z)(e.createdAt.toDate());return{...e,createdAt:n}}))})),t=(0,S.iH)(null);return(0,o.ic)((()=>{t.value.scrollTop=t.value.scrollHeight})),{error:e,documents:n,formattedDocuments:r,messages:t}}};const Oe=(0,l.Z)(He,[["render",ke]]);var je=Oe,Ze={components:{NavBar:te,NewChatForm:he,ChatWindow:je},setup(){const{user:e}=ee(),n=(0,c.tv)();(0,o.YP)(e,(()=>{e.value||n.push({name:"welcome"})}))}};const xe=(0,l.Z)(Ze,[["render",ie]]);var Ae=xe;const Le=(e,n,r)=>{let t=U.currentUser;console.log("current user in auth guard:",t),t?r():r({name:"welcome"})},Ve=(e,n,r)=>{let t=U.currentUser;t?r({name:"chatroom"}):r()},Ne=[{path:"/",name:"welcome",component:le,beforeEnter:Ve},{path:"/chatroom",name:"chatroom",component:Ae,beforeEnter:Le}],We=(0,c.p7)({history:(0,c.PO)("/"),routes:Ne});var ze=We;let Ee;U.onAuthStateChanged((()=>{Ee||(Ee=(0,t.ri)(i).use(ze).mount("#app"))}))}},n={};function r(t){var o=n[t];if(void 0!==o)return o.exports;var a=n[t]={id:t,loaded:!1,exports:{}};return e[t].call(a.exports,a,a.exports,r),a.loaded=!0,a.exports}r.m=e,function(){var e=[];r.O=function(n,t,o,a){if(!t){var l=1/0;for(c=0;c<e.length;c++){t=e[c][0],o=e[c][1],a=e[c][2];for(var s=!0,u=0;u<t.length;u++)(!1&a||l>=a)&&Object.keys(r.O).every((function(e){return r.O[e](t[u])}))?t.splice(u--,1):(s=!1,a<l&&(l=a));if(s){e.splice(c--,1);var i=o();void 0!==i&&(n=i)}}return n}a=a||0;for(var c=e.length;c>0&&e[c-1][2]>a;c--)e[c]=e[c-1];e[c]=[t,o,a]}}(),function(){r.n=function(e){var n=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(n,{a:n}),n}}(),function(){r.d=function(e,n){for(var t in n)r.o(n,t)&&!r.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:n[t]})}}(),function(){r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){r.hmd=function(e){return e=Object.create(e),e.children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:function(){throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e}}(),function(){r.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)}}(),function(){r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={143:0};r.O.j=function(n){return 0===e[n]};var n=function(n,t){var o,a,l=t[0],s=t[1],u=t[2],i=0;if(l.some((function(n){return 0!==e[n]}))){for(o in s)r.o(s,o)&&(r.m[o]=s[o]);if(u)var c=u(r)}for(n&&n(t);i<l.length;i++)a=l[i],r.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return r.O(c)},t=self["webpackChunklive_chat"]=self["webpackChunklive_chat"]||[];t.forEach(n.bind(null,0)),t.push=n.bind(null,t.push.bind(t))}();var t=r.O(void 0,[998],(function(){return r(3936)}));t=r.O(t)})();
//# sourceMappingURL=app.54c80b19.js.map