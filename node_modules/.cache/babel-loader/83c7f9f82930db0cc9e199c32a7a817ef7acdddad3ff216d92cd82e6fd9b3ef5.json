{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { ref, watchEffect } from 'vue';\nimport { projectFireStore } from '../firebase/config';\nconst getCollection = collection => {\n  const documents = ref(null);\n  const error = ref(null);\n  let collectionRef = projectFireStore.collection(collection).orderBy('createdAt');\n  const unsub = collectionRef.onSnapshot(snap => {\n    console.log('snapshot');\n    let results = [];\n    snap.docs.forEach(doc => {\n      doc.data().createdAt && results.push({\n        ...doc.data(),\n        id: doc.id\n      });\n      //results.push({...doc.data(), id: doc.id})\n    });\n\n    documents.value = results;\n    error.value = null;\n  }, err => {\n    console.log(err.message);\n    documents.value = null;\n    error.value = \"Could not fetch data\";\n  });\n  watchEffect(onInvalidate => {\n    //unsub from prev collection when watcher is stoppped (component unmounted)\n    onInvalidate(() => unsub());\n  });\n  return {\n    documents,\n    error\n  };\n};\nexport default getCollection;","map":{"version":3,"names":["ref","watchEffect","projectFireStore","getCollection","collection","documents","error","collectionRef","orderBy","unsub","onSnapshot","snap","console","log","results","docs","forEach","doc","data","createdAt","push","id","value","err","message","onInvalidate"],"sources":["C:/Users/lego5/Desktop/ppp/live-chat-2/src/composables/getCollection.js"],"sourcesContent":["import {ref, watchEffect} from 'vue'\r\nimport {projectFireStore} from '../firebase/config'\r\n\r\n\r\n\r\nconst getCollection = (collection) => {\r\n    const documents = ref(null)\r\n    const error = ref(null)\r\n\r\n    let collectionRef = projectFireStore.collection(collection)\r\n    .orderBy('createdAt')\r\n\r\n    const unsub = collectionRef.onSnapshot((snap) => {\r\n        console.log('snapshot')\r\n        let results = []\r\n        snap.docs.forEach(doc => {\r\n            doc.data().createdAt && results.push({...doc.data(), id: doc.id})\r\n            //results.push({...doc.data(), id: doc.id})\r\n            })\r\n            documents.value = results\r\n            error.value = null\r\n        }, (err) => {\r\n            console.log(err.message)\r\n            documents.value = null\r\n            error.value = \"Could not fetch data\" \r\n        })\r\n\r\n        watchEffect((onInvalidate) => {\r\n            //unsub from prev collection when watcher is stoppped (component unmounted)\r\n            onInvalidate( () => unsub())}\r\n        )\r\n\r\n        return { documents, error}\r\n}\r\n\r\nexport default getCollection"],"mappings":";AAAA,SAAQA,GAAG,EAAEC,WAAW,QAAO,KAAK;AACpC,SAAQC,gBAAgB,QAAO,oBAAoB;AAInD,MAAMC,aAAa,GAAIC,UAAU,IAAK;EAClC,MAAMC,SAAS,GAAGL,GAAG,CAAC,IAAI,CAAC;EAC3B,MAAMM,KAAK,GAAGN,GAAG,CAAC,IAAI,CAAC;EAEvB,IAAIO,aAAa,GAAGL,gBAAgB,CAACE,UAAU,CAACA,UAAU,CAAC,CAC1DI,OAAO,CAAC,WAAW,CAAC;EAErB,MAAMC,KAAK,GAAGF,aAAa,CAACG,UAAU,CAAEC,IAAI,IAAK;IAC7CC,OAAO,CAACC,GAAG,CAAC,UAAU,CAAC;IACvB,IAAIC,OAAO,GAAG,EAAE;IAChBH,IAAI,CAACI,IAAI,CAACC,OAAO,CAACC,GAAG,IAAI;MACrBA,GAAG,CAACC,IAAI,EAAE,CAACC,SAAS,IAAIL,OAAO,CAACM,IAAI,CAAC;QAAC,GAAGH,GAAG,CAACC,IAAI,EAAE;QAAEG,EAAE,EAAEJ,GAAG,CAACI;MAAE,CAAC,CAAC;MACjE;IACA,CAAC,CAAC;;IACFhB,SAAS,CAACiB,KAAK,GAAGR,OAAO;IACzBR,KAAK,CAACgB,KAAK,GAAG,IAAI;EACtB,CAAC,EAAGC,GAAG,IAAK;IACRX,OAAO,CAACC,GAAG,CAACU,GAAG,CAACC,OAAO,CAAC;IACxBnB,SAAS,CAACiB,KAAK,GAAG,IAAI;IACtBhB,KAAK,CAACgB,KAAK,GAAG,sBAAsB;EACxC,CAAC,CAAC;EAEFrB,WAAW,CAAEwB,YAAY,IAAK;IAC1B;IACAA,YAAY,CAAE,MAAMhB,KAAK,EAAE,CAAC;EAAA,CAAC,CAChC;EAED,OAAO;IAAEJ,SAAS;IAAEC;EAAK,CAAC;AAClC,CAAC;AAED,eAAeH,aAAa"},"metadata":{},"sourceType":"module","externalDependencies":[]}